#Either import the included business_projected.json, or recreate the massaged collection by running the aggregation below

#Use projection to "flatten" the nested attributes from the business collection and write out to new collection "business_projected"

db.business.aggregate( [ { $project: {"BikeParking":"$attributes.BikeParking", "BusinessAcceptsBitcoin":"$attributes.BusinessAcceptsBitcoin", "BusinessAcceptsCreditCards":"$attributes.BusinessAcceptsCreditCards", "BusinessParking_Garage":"$attributes.BusinessParking.garage", "BusinessParking_Lot":"$attributes.BusinessParking.lot", "BusinessParking_Street":"$attributes.BusinessParking.street", "BusinessParking_Valet":"$attributes.BusinessParking.valet", "BusinessParking_validated":"$attributes.BusinessParking.validated", "DogsAllowed":"$attributes.DogsAllowed", "GoodForKids":"$attributes.GoodForKids", "HasTV":"$attributes.HasTV", "NoiseLevel":"$attributes.NoiseLevel", "Open24Hours":"$attributes.Open24Hours", "OutdoorSeating":"$attributes.OutdoorSeating", "Smoking":"$attributes.Smoking", "WheelchairAccessible":"$attributes.WheelchairAccessible", "WiFi":"$attributes.WiFi", "City":"$city", "Hours_Friday":"$hours.Friday", "Hours_Monday":"$hours.Monday", "Hours_Saturday":"$hours.Saturday", "Hours_Sunday":"$hours.Sunday", "Hours_Thursday":"$hours.Thursday", "Hours_Tuesday":"$hours.Tuesday", "Hours_Wednesday":"$hours.Wednesday", "PostalCode":"$postal_code", "ReviewCount":"$review_count", "Stars":"$stars", "State":"$state"}}, { $out:"business_projected" } ] )